HCanAWR.controllers.SplashScreenController = Ext.extend(Ext.Controller, {
	init: function(callback) {
		var that = this;
		HCanAWR.mon(HCanAWR, 'ShowSplashScreenView', this.showSplashScreenView, this);
		HCanAWR.mon(HCanAWR, 'ShowLanguageSelection', this.showLanguageSelection, this);
		
		this.view = new HCanAWR.views.SplashScreenView();
		this.view.init(function() {
			callback(that.view);
		});
		
	},
	
	showSplashScreenView: function() {
		HCanAWR.fireEvent('ShowView', 'SplashScreen');
	},
	
	showLanguageSelection: function() {
		Ext.each(['English','French'], function(lang) {
			this.view.mon(
				this.view.buttonContainer.items.get('splashScreen'+lang+'LanguageButton'),
				'tap',
				this.viewHandlers['select'+lang+'Language'],
				this,
				{single:true}
			);
		}, this);
		
		this.view.showLanguageSelection();
		
		// We are ready to show the view
		HCanAWR.fireEvent('ShowView', 'SplashScreen');
	},
	
	viewHandlers: {
		selectEnglishLanguage: function() {
			this.viewHandlers.selectLanguage.call(this, 'en');
		},
		selectFrenchLanguage: function() {
			this.viewHandlers.selectLanguage.call(this, 'fr');
		},
		selectLanguage: function(lang) {
			this.view.hideLanguageSelection();
			HCanAWR.fireEvent('LanguageSelected', lang);
		}
	},
	
	destroy: function() {
		this.view.destroy();
	}
});
