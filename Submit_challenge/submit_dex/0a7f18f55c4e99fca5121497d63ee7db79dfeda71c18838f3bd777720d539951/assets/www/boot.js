
deviceReady = Ext.is.Desktop;
domReady = false;
appStarted = false;

document.addEventListener("deviceready", onDeviceReady, false);

function getStr(key) {
	var value = key;
	
	if (
	  HCanAWR.language
	  && HCanAWR.language in HCanAWRLocale
	  && key in HCanAWRLocale[HCanAWR.language] ) {
		value = HCanAWRLocale[HCanAWR.language][key];
	} else {
		console.error('Could not get locale string for key: ' + key );
	}
	
	return value;
}

function onBodyLoad() {
	domReady = true;
	startApplication();
}

function onDeviceReady() {
	deviceReady = true;
	startApplication();
}

function startApplication() {
	if ( !deviceReady || !domReady || appStarted ) {
			return;
	}

	appStarted = true;
	
	/* We have to delay by >50ms to allow the gesture manager to load.
	 * If we don't, our whole app loads before the gesture manager
	 * gets a chance to start, which causes breakage later.
	 */
	Ext.onReady(
		function() {
			setTimeout(function() {
				HCanAWR.init();
			}, 51);
		},
		this,
		{single:true}
	);
}